# EC2 기초
AWS가 제공하는 서비스 중 가장 많이 사용 되는 것 중 하나   
Elastic Compute Cloud, 인프라 서비스
### 기능
- EC2 인스턴스: 가상머신 임대
- EBS Volume: 가상 드라이브에 데이터 저장
- ELB: 여러 머신에 로드 분산
- ASG: 오토 스케일링 그룹, 서비스 확장

### EC2 인스턴스에 사용 가능한 옵션
1. 사용 가능한 운영체제
    1. 리눅스, 윈도우, 맥 OS
2. 컴퓨터 성능, 코어 수 (CPU)
3. 랜덤 액세스 메모리, 램 용량
4. 스토리지 용량
    1. 네트워크를 통해 연결 되는 스토리지 (EBS, EFS)
    2. 하드웨어에 연결되는 스토리지 (EC2 Instance Store)
5. 네트워크 유형 (네트워크 카트 속도, 사용할 공개 IP)
6. 방화벽 규칙 정의 (보안 그룹)
7. 부트스트랩 스크립트
   1. 처음 시작할 때의 인스턴스를 구성, EC2 사용자 데이터

# EC2 인스턴스 유형 및 기본 사항
### 명명 규칙
ex) m5.2xlarge
- m = 인스턴스 클래스, 범용의 인스턴스
- 5 = 인스턴스의 세대 (AWS가 하드웨어를 계속 개선함)
- 2xlarge = 크기 (small ~), 크기가 클 수록 더 많은 메모리와 CPU를 가지게 된다

### General Purpose (범용)
- 웹 서버나 코드 저장소와 같은 다양한 작업에 적합
- 컴퓨팅, 메모리, 네트워킹 간의 균형이 잘 맞음

### Compute Optimized (컴퓨팅 최적화)
- C로 시작함
- 컴퓨터 집약적인 작업에 최적화
- 고성능 프로세서 → 일부 데이터의 일괄 처리
- 미디어 트랜스코딩
- 고성능 웹 서버
- 고성능 컴퓨팅 (HPC)
- 머신 러닝
- 전용 게임 서버

### Memory Optimized (메모리 최적화)
- R로 시작함 (X1, z로 시작하는 애도 있긴 함)
- 메모리에서 대규모 데이터셋을 처리하는 유형의 작업에 빠른 성능을 제공
- 인 메모리 데이터베이스가 되는 고성능 관계형 또는 비관계형의 데이터베이스
- BI에 최적화 된 인 메모리 데이터베이스
- 대규모 비정형 데이터의 실시간 처리를 실행하는 애플리케이션

### Storage Optimized (스토리지 최적화)
- I, G 또는 H1
- 로컬 스트리지에서 대규모의 데이터셋에 액세스 할 때 적합
- 고주파 온라인 트랜잭션 처리인 OLTP 시스템에 사용
- 관계형과 비관계형인 NoSQL 데이터베이스에 사용
- 메모리 데이터베이스의 캐시나 데이터 웨어하우징 애플리케이션
- 분산 파일 시스템

# 보안 그룹 및 클래식 포트 개요
## 보안 그룹 (방화벽)
- 보안 그룹은 AWS 클라우드에서 네트워크 보안을 수행하는 데에 있어 기본
- EC2 인스턴스 안팎으로 트래픽이 허용되는 방식을 제어
- 허용 규칙만 포함 되어 있음 (무엇이 들어가고 나갈 수 있는지)
- IP 주소를 기준으로 규칙을 설정
- 다른 보안 그룹을 참조하여 설정 가능

### Deeper Dive…
- 포트에 대한 액세스 규제
- 승인된 IP 범위 표시 (IPv4인지 v6인지)
- 인바운드 네트워크 제어 (외부에서 안으로)
- 아웃바운드 네트워크 제어 (인스턴스에서 외부로 나가는 것)

### Good to know
- 여러 인스턴스에 연결할 수 있음
    - 보안 그룹과 인스턴스 사이에는 1:1 관계가 없음
- 특정 지역(region)과 VPC 조합에만 제한
- 보안 그룹은 EC2 외부에 있음
    - 트래픽이 차단 되면 EC2 인스턴스는 트래픽을 볼 수 없음
- SSH 액세스를 위해서만 별도의 보안 그룹을 하나 유지하는 것이 좋다,,
- 애플리케이션에 접근할 수 없는 경우(타임아웃) → 보안 그룹 문제
    - 임의의 포트에 연결하려고 하는데 대기 중이라면 보안 그룹 문제일 가능성이 큼
    - 연결 거부 오류가 발생하면 실제로 연결이 거부 되었다는 응답을 받음 = 보안 그룹 작동해서 트래픽이 통과했지만 애플리케이션이 오류가 나거나, 실행되지 않은 것
- 기본적으로 모든 인바운드 트래픽은 차단 되고 모든 아웃바운드 트래픽은 승인 된다

# SSH 개요
유지 관리나 작업을 위해 서버 내부에 연결하는 방법   
리눅스 서버에서는 SSH, 보안 셸을 통해 서버에 연결함

- SSH: 명령줄 인터페이스 유틸리티 (맥, 리눅스, 윈도우 버전 10 이상)
- Putty: 모든 버전의 윈도우
- EC2 Instance Connect: 웹 브라우저 사용 (맥, 리눅스, 윈도우 모든 버전에서 사용 가능)

# EC2 인스턴스 구매 옵션
### On-Demand Instances (온디맨드 EC2 인스턴스)
- 여태 사용한 거
- 요청에 따라 언제든 인스턴스 실행 가능 > 단기 워크로드에 어울림
- 가격 예측 가능, 초당 비용 지불
- 사용한 만큼 지불
- 운영체제에 따른 청구
    - Linux, Windows 사용 시 첫 1분이 지난 이후부터 초당 비용 청구
    - 그 외 운영 체제: 시간 당 비용 청구
- 가격은 제일 높지만 선결제 없고 장기 약정 필요 없음
- 애플리케이션 동작을 예측할 수 없을 때, 연속적인 단기 워크로드 적합

### Reserved (1년 or 3년)
- 예약 인스턴스
    - 장기 워크로드에 어울림
    - 데이터베이스를 오래 사용하기로 했을 때
- Convertible Reserved Instances (전환형 예약 인스턴스)
    - 유연성 있는 인스턴스
    - 시간에 따라 인스턴스의 유형을 변경하고 싶을 때
- 온디맨드에 비해 비용을 72퍼센트 절약
- 특정 인스턴스 속성 예약
- 종류
    - 전환형 예약 인스턴스 (인스턴스 제품군, 운영체제 및 범위, 테넌시 변경 가능)

### Saving Plans (1년 or 3년)
- 특정 사용량을 약정하여 달러로 지불
- 장기 워크로드에 특화
- 70% 가까이 할인
- 시간 당 10달러의 비용을 1년에서 3년 동안 약정
- 예약보다 초과하는 사용량은 온디맨드 가격으로 청구

### Spot Instances
- 아주 짧음.. 상당히 저렴
- 언제든 인스턴스 손실 가능
- 신뢰성 낮음
- 온디맨드와 비교하여 최대 90%까지 할인
- 인스턴스가 언제든 중단 될 수 있음
- 내가 지불하고자 한 금액보다 스팟이 높아질 경우 인스턴스 중단
- 비용 효율적
- 서비스가 중단 되어도 복구하기 쉬운 워크로드에 매우 큰 도움
    - 배치 작업, 데이터 분석 및 이미지 처리
    - 분산된 워크로드 또는 시작 및 종료 ㅅ점이 유동적인 워크로드
- 중요한 작업이나 데이터베이스에는 적합 X

### Dedicated Hosts (전용 호스트)
- 물리적 서버 전체 예약
- 인스턴스 배치 제어 가능
- 규정 준수 요구 사항이 있거나 기존의 서버 결합 소프트웨어 라이선스를 사용해야 할 경우
- 소켓 당 코어 당, 또한 VM 소프트웨어 라이선스 당 청구
- 물리적 서버에 액세스 하고 전용 호스트가 필요한 사례
- 실제로 물리적인 서버를 사용하기에 가장 비쌈

### Dedicated Instances(전용 인스턴스)
- 하드웨어를 공유하지 않음
- 사용자 전용 하드웨어에 실행되는 인스턴스
- 같은 계정의 다른 인스턴스와 하드웨어를 공유하기도 함
- 인스턴스 배치는 제어할 수 없음

### Capacity Reservations
- 용량 예약, 특정 AZ의 용량을 원하는 기간 동안 예약
- 시간 약정이 없기 때문에 언제든지 용량을 예약하거나 취소할 수 있음 (요금 할인 없음)
- 요금을 할인 받으려면 리전 예약 인스턴스 혹은 Saving Plans와 결합 필요